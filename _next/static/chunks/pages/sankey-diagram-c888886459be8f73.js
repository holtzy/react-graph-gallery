(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5654],{1248:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sankey-diagram",function(){return n(6444)}])},6820:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(5893);n(7294);var i=n(8843),o=n(6438);let a=e=>{let{imgLink:t,height:n,opacity:i,children:o}=e;return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{style:{backgroundImage:"url("+t+")",height:n,backgroundAttachment:"fixed",opacity:i,backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}}),(0,r.jsx)("div",{className:"absolute top-0 left-0 w-full h-full",children:o})]})};function s(e){var t;let{chartId:n}=e,s=(null===(t=i.c.find(e=>e.id===n))||void 0===t?void 0:t.label)||"chart";return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{id:"inspiration",children:s+" inspiration"}),(0,r.jsxs)("p",{children:["If you're looking for inspiration to create your next"," ",(0,r.jsx)("span",{children:s}),", note that"," ",(0,r.jsx)("a",{href:"https://www.dataviz-inspiration.com",children:"dataviz-inspiration.com"})," ","showcases many examples. Definitely the best place to get ... inspiration!"]}),(0,r.jsx)("div",{className:"border mb-10",children:(0,r.jsx)(a,{height:250,imgLink:"https://github.com/holtzy/dataviz-inspiration/blob/main/public/misc/overview1.png?raw=true",opacity:.3,children:(0,r.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,r.jsxs)("div",{style:{maxWidth:400},className:"flex flex-col items-center",children:[(0,r.jsxs)("p",{className:"text-center text-sm",children:[(0,r.jsx)("a",{href:"https://www.dataviz-inspiration.com",children:"dataviz-inspiration.com"})," ","showcases hundreds of stunning dataviz projects. Have a look to get some ideas on how to make your ",(0,r.jsx)("span",{children:s})," ","looks good!"]}),(0,r.jsx)(o.J,{href:"https://www.dataviz-inspiration.com",isFilled:!0,size:"md",children:"visit"})]})})})})]})}},505:function(e,t,n){"use strict";n.d(t,{r:function(){return c}});var r=n(5893),i=n(1664),o=n.n(i),a=n(8843),s=n(88),l=n(3572);let c=e=>{let{chartId:t}=e,n=a.c.filter(e=>e.id===t)[0].label;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("h2",{id:"responsiveness",children:"Responsive "+n+" with react"}),(0,r.jsxs)("p",{children:["The component above is not responsive. It expects 2 props called"," ",(0,r.jsx)("code",{children:"width"})," and ",(0,r.jsx)("code",{children:"height"})," and will render a ",n," of those dimensions."]}),(0,r.jsxs)("p",{children:["Making the ",n," responsive requires adding a ",(0,r.jsx)("b",{children:"wrapper"})," component that gets the dimension of the parent ",(0,r.jsx)("code",{children:"div"}),", and listening to a potential dimension change. This is possible thanks to a hook called"," ",(0,r.jsx)("code",{children:"useDimensions"})," that will do the job for us."]}),(0,r.jsx)(s.U,{startOpen:!1,title:(0,r.jsxs)("span",{children:[(0,r.jsx)("code",{children:"useDimensions"}),": a hook to make your viz responsive"]}),children:(0,r.jsx)(l.d,{code:d})}),(0,r.jsxs)("p",{children:["I'm in the process of writing a complete blog post on the topic."," ",(0,r.jsx)(o(),{href:"/subscribe",children:"Subscribe to the project"})," to know when it's ready."]}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{})]})},d='\nexport const useDimensions = (targetRef: React.RefObject<HTMLDivElement>) => {\n\n  const getDimensions = () => {\n    return {\n      width: targetRef.current ? targetRef.current.offsetWidth : 0,\n      height: targetRef.current ? targetRef.current.offsetHeight : 0\n    };\n  };\n\n  const [dimensions, setDimensions] = useState(getDimensions);\n\n  const handleResize = () => {\n    setDimensions(getDimensions());\n  };\n\n  useEffect(() => {\n    window.addEventListener("resize", handleResize);\n    return () => window.removeEventListener("resize", handleResize);\n  }, []);\n\n  useLayoutEffect(() => {\n    handleResize();\n  }, []);\n\n  return dimensions;\n}\n'.trim()},8893:function(e,t,n){"use strict";n.d(t,{H:function(){return i}});var r=n(5893);let i=e=>{let{text:t}=e;return(0,r.jsxs)("blockquote",{className:"mt-10 opacity-20",children:[(0,r.jsx)("b",{className:"text-reactGallery mr-4",children:"ToDo"}),t]})}},6444:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return en}});var r=n(5893);n(7294);var i=n(153),o=n(9965),a=n(7262),s=n(3572),l=n(1122),c=n(6820),d=n(505),h=n(8893);let u={nodes:[{id:"bob"},{id:"alice"},{id:"carol"},{id:"mel"},{id:"yan"}],links:[{source:"bob",target:"carol",value:4},{source:"alice",target:"carol",value:3},{source:"alice",target:"yan",value:1},{source:"carol",target:"mel",value:6},{source:"carol",target:"yan",value:1}]};function g(e,t){let n=0;if(void 0===t)for(let t of e)(t=+t)&&(n+=t);else{let r=-1;for(let i of e)(i=+t(i,++r,e))&&(n+=i)}return n}function f(e,t){let n;if(void 0===t)for(let t of e)null!=t&&(n<t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function y(e,t){let n;if(void 0===t)for(let t of e)null!=t&&(n>t||void 0===n&&t>=t)&&(n=t);else{let r=-1;for(let i of e)null!=(i=t(i,++r,e))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function m(e){return e.target.depth}function p(e,t){return e.sourceLinks.length?e.depth:t-1}function x(e){return e.targetLinks.length?e.depth:e.sourceLinks.length?y(e.sourceLinks,m)-1:0}function v(e){return function(){return e}}function j(e,t){return k(e.source,t.source)||e.index-t.index}function w(e,t){return k(e.target,t.target)||e.index-t.index}function k(e,t){return e.y0-t.y0}function b(e){return e.value}function _(e){return e.index}function L(e){return e.nodes}function S(e){return e.links}function T(e,t){let n=e.get(t);if(!n)throw Error("missing: "+t);return n}function E({nodes:e}){for(let t of e){let e=t.y0,n=e;for(let n of t.sourceLinks)n.y0=e+n.width/2,e+=n.width;for(let e of t.targetLinks)e.y1=n+e.width/2,n+=e.width}}function A(){let e,t,n=0,r=0,i=1,o=1,a=24,s=8,l,c=_,d=p,h=L,u=S,m=6;function x(){let p={nodes:h.apply(null,arguments),links:u.apply(null,arguments)};return function({nodes:e,links:n}){for(let[t,n]of e.entries())n.index=t,n.sourceLinks=[],n.targetLinks=[];let r=new Map(e.map((t,n)=>[c(t,n,e),t]));for(let[e,t]of n.entries()){t.index=e;let{source:n,target:i}=t;"object"!=typeof n&&(n=t.source=T(r,n)),"object"!=typeof i&&(i=t.target=T(r,i)),n.sourceLinks.push(t),i.targetLinks.push(t)}if(null!=t)for(let{sourceLinks:n,targetLinks:r}of e)n.sort(t),r.sort(t)}(p),function({nodes:e}){for(let t of e)t.value=void 0===t.fixedValue?Math.max(g(t.sourceLinks,b),g(t.targetLinks,b)):t.fixedValue}(p),function({nodes:e}){let t=e.length,n=new Set(e),r=new Set,i=0;for(;n.size;){for(let e of n)for(let{target:t}of(e.depth=i,e.sourceLinks))r.add(t);if(++i>t)throw Error("circular link");n=r,r=new Set}}(p),function({nodes:e}){let t=e.length,n=new Set(e),r=new Set,i=0;for(;n.size;){for(let e of n)for(let{source:t}of(e.height=i,e.targetLinks))r.add(t);if(++i>t)throw Error("circular link");n=r,r=new Set}}(p),function(c){let h=function({nodes:t}){let r=f(t,e=>e.depth)+1,o=(i-n-a)/(r-1),s=Array(r);for(let e of t){let t=Math.max(0,Math.min(r-1,Math.floor(d.call(null,e,r))));e.layer=t,e.x0=n+t*o,e.x1=e.x0+a,s[t]?s[t].push(e):s[t]=[e]}if(e)for(let t of s)t.sort(e);return s}(c);l=Math.min(s,(o-r)/(f(h,e=>e.length)-1)),function(e){let n=y(e,e=>(o-r-(e.length-1)*l)/g(e,b));for(let i of e){let e=r;for(let t of i)for(let r of(t.y0=e,t.y1=e+t.value*n,e=t.y1+l,t.sourceLinks))r.width=r.value*n;e=(o-e+l)/(i.length+1);for(let t=0;t<i.length;++t){let n=i[t];n.y0+=e*(t+1),n.y1+=e*(t+1)}(function(e){if(void 0===t)for(let{sourceLinks:t,targetLinks:n}of e)t.sort(w),n.sort(j)})(i)}}(h);for(let t=0;t<m;++t){let n=Math.pow(.99,t),r=Math.max(1-n,(t+1)/m);(function(t,n,r){for(let i=t.length,o=i-2;o>=0;--o){let i=t[o];for(let e of i){let t=0,r=0;for(let{target:n,value:i}of e.sourceLinks){let o=i*(n.layer-e.layer);t+=function(e,t){let n=t.y0-(t.targetLinks.length-1)*l/2;for(let{source:r,width:i}of t.targetLinks){if(r===e)break;n+=i+l}for(let{target:r,width:i}of e.sourceLinks){if(r===t)break;n-=i}return n}(e,n)*o,r+=o}if(!(r>0))continue;let i=(t/r-e.y0)*n;e.y0+=i,e.y1+=i,I(e)}void 0===e&&i.sort(k),A(i,r)}})(h,n,r),function(t,n,r){for(let i=1,o=t.length;i<o;++i){let o=t[i];for(let e of o){let t=0,r=0;for(let{source:n,value:i}of e.targetLinks){let o=i*(e.layer-n.layer);t+=function(e,t){let n=e.y0-(e.sourceLinks.length-1)*l/2;for(let{target:r,width:i}of e.sourceLinks){if(r===t)break;n+=i+l}for(let{source:r,width:i}of t.targetLinks){if(r===e)break;n-=i}return n}(n,e)*o,r+=o}if(!(r>0))continue;let i=(t/r-e.y0)*n;e.y0+=i,e.y1+=i,I(e)}void 0===e&&o.sort(k),A(o,r)}}(h,n,r)}}(p),E(p),p}function A(e,t){let n=e.length>>1,i=e[n];M(e,i.y0-l,n-1,t),D(e,i.y1+l,n+1,t),M(e,o,e.length-1,t),D(e,r,0,t)}function D(e,t,n,r){for(;n<e.length;++n){let i=e[n],o=(t-i.y0)*r;o>1e-6&&(i.y0+=o,i.y1+=o),t=i.y1+l}}function M(e,t,n,r){for(;n>=0;--n){let i=e[n],o=(i.y1-t)*r;o>1e-6&&(i.y0-=o,i.y1-=o),t=i.y0-l}}function I({sourceLinks:e,targetLinks:n}){if(void 0===t){for(let{source:{sourceLinks:e}}of n)e.sort(w);for(let{target:{targetLinks:t}}of e)t.sort(j)}}return x.update=function(e){return E(e),e},x.nodeId=function(e){return arguments.length?(c="function"==typeof e?e:v(e),x):c},x.nodeAlign=function(e){return arguments.length?(d="function"==typeof e?e:v(e),x):d},x.nodeSort=function(t){return arguments.length?(e=t,x):e},x.nodeWidth=function(e){return arguments.length?(a=+e,x):a},x.nodePadding=function(e){return arguments.length?(s=l=+e,x):s},x.nodes=function(e){return arguments.length?(h="function"==typeof e?e:v(e),x):h},x.links=function(e){return arguments.length?(u="function"==typeof e?e:v(e),x):u},x.linkSort=function(e){return arguments.length?(t=e,x):t},x.size=function(e){return arguments.length?(n=r=0,i=+e[0],o=+e[1],x):[i-n,o-r]},x.extent=function(e){return arguments.length?(n=+e[0][0],i=+e[1][0],r=+e[0][1],o=+e[1][1],x):[[n,r],[i,o]]},x.iterations=function(e){return arguments.length?(m=+e,x):m},x}var D=Math.PI,M=2*D,I=M-1e-6;function N(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function H(){return new N}N.prototype=H.prototype={constructor:N,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,i,o){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+i)+","+(this._y1=+o)},arcTo:function(e,t,n,r,i){e=+e,t=+t,n=+n,r=+r,i=+i;var o=this._x1,a=this._y1,s=n-e,l=r-t,c=o-e,d=a-t,h=c*c+d*d;if(i<0)throw Error("negative radius: "+i);if(null===this._x1)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(h>1e-6){if(Math.abs(d*s-l*c)>1e-6&&i){var u=n-o,g=r-a,f=s*s+l*l,y=Math.sqrt(f),m=Math.sqrt(h),p=i*Math.tan((D-Math.acos((f+h-(u*u+g*g))/(2*y*m)))/2),x=p/m,v=p/y;Math.abs(x-1)>1e-6&&(this._+="L"+(e+x*c)+","+(t+x*d)),this._+="A"+i+","+i+",0,0,"+ +(d*u>c*g)+","+(this._x1=e+v*s)+","+(this._y1=t+v*l)}else this._+="L"+(this._x1=e)+","+(this._y1=t)}},arc:function(e,t,n,r,i,o){e=+e,t=+t,n=+n,o=!!o;var a=n*Math.cos(r),s=n*Math.sin(r),l=e+a,c=t+s,d=1^o,h=o?r-i:i-r;if(n<0)throw Error("negative radius: "+n);null===this._x1?this._+="M"+l+","+c:(Math.abs(this._x1-l)>1e-6||Math.abs(this._y1-c)>1e-6)&&(this._+="L"+l+","+c),n&&(h<0&&(h=h%M+M),h>I?this._+="A"+n+","+n+",0,1,"+d+","+(e-a)+","+(t-s)+"A"+n+","+n+",0,1,"+d+","+(this._x1=l)+","+(this._y1=c):h>1e-6&&(this._+="A"+n+","+n+",0,"+ +(h>=D)+","+d+","+(this._x1=e+n*Math.cos(i))+","+(this._y1=t+n*Math.sin(i))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var z=Array.prototype.slice;function G(e){return function(){return e}}function O(e){return e[0]}function R(e){return e[1]}function W(e){return e.source}function C(e){return e.target}function q(e,t,n,r,i){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,i,r,i)}function P(e){return[e.source.x1,e.y0]}function B(e){return[e.target.x0,e.y1]}function F(){return(function(e){var t=W,n=C,r=O,i=R,o=null;function a(){var a,s=z.call(arguments),l=t.apply(this,s),c=n.apply(this,s);if(o||(o=a=H()),e(o,+r.apply(this,(s[0]=l,s)),+i.apply(this,s),+r.apply(this,(s[0]=c,s)),+i.apply(this,s)),a)return o=null,a+""||null}return a.source=function(e){return arguments.length?(t=e,a):t},a.target=function(e){return arguments.length?(n=e,a):n},a.x=function(e){return arguments.length?(r="function"==typeof e?e:G(+e),a):r},a.y=function(e){return arguments.length?(i="function"==typeof e?e:G(+e),a):i},a.context=function(e){return arguments.length?(o=null==e?null:e,a):o},a})(q).source(P).target(B)}let V=e=>{let{width:t,height:n,data:i}=e,o=A().nodeWidth(26).nodePadding(29).extent([[5,25],[t-5,n-25]]).nodeId(e=>e.id).nodeAlign(x),{nodes:a,links:s}=o(i),l=a.map(e=>(0,r.jsx)("g",{children:(0,r.jsx)("rect",{height:e.y1-e.y0,width:o.nodeWidth(),x:e.x0,y:e.y0,stroke:"black",fill:"#a53253",fillOpacity:.8,rx:.9})},e.index)),c=s.map((e,t)=>{let n=F(),i=n(e);return(0,r.jsx)("path",{d:i,stroke:"#a53253",fill:"none",strokeOpacity:.1,strokeWidth:e.width},t)});return(0,r.jsx)("div",{children:(0,r.jsxs)("svg",{width:t,height:n,children:[l,c]})})},Z=e=>{let{width:t=700,height:n=400}=e;return 0===t?null:(0,r.jsx)(V,{data:u,width:t,height:n})},K={nodes:[{id:"bob"},{id:"alice"},{id:"carol"},{id:"mel"},{id:"yan"}],links:[{source:"bob",target:"carol",value:4},{source:"alice",target:"carol",value:3},{source:"alice",target:"yan",value:1},{source:"carol",target:"mel",value:6},{source:"carol",target:"yan",value:1}]},U=e=>{let{width:t,height:n,data:i}=e,o=A().nodeWidth(26).nodePadding(29).extent([[5,25],[t-5,n-25]]).nodeId(e=>e.id).nodeAlign(x),{nodes:a,links:s}=o(i),l=a.map(e=>(0,r.jsx)("g",{children:(0,r.jsx)("rect",{height:e.y1-e.y0,width:o.nodeWidth(),x:e.x0,y:e.y0,stroke:"black",fill:"#a53253",fillOpacity:.8,rx:.9})},e.index));return(0,r.jsx)("div",{children:(0,r.jsx)("svg",{width:t,height:n,children:l})})},X=e=>{let{width:t=700,height:n=400}=e;return 0===t?null:(0,r.jsx)(U,{data:K,width:t,height:n})},$={nodes:[{name:"Agricultural 'waste'",category:"Agricultural"},{name:"Bio-conversion",category:"Bio-conversion"},{name:"Liquid",category:"Liquid"},{name:"Losses",category:"Losses"},{name:"Solid",category:"Solid"},{name:"Gas",category:"Gas"},{name:"Biofuel imports",category:"Biofuel"},{name:"Biomass imports",category:"Biomass"},{name:"Coal imports",category:"Coal"},{name:"Coal",category:"Coal"},{name:"Coal reserves",category:"Coal"},{name:"District heating",category:"District"},{name:"Industry",category:"Industry"},{name:"Heating and cooling - commercial",category:"Heating"},{name:"Heating and cooling - homes",category:"Heating"},{name:"Electricity grid",category:"Electricity"},{name:"Over generation / exports",category:"Over"},{name:"H2 conversion",category:"H2"},{name:"Road transport",category:"Road"},{name:"Agriculture",category:"Agriculture"},{name:"Rail transport",category:"Rail"},{name:"Lighting & appliances - commercial",category:"Lighting"},{name:"Lighting & appliances - homes",category:"Lighting"},{name:"Gas imports",category:"Gas"},{name:"Ngas",category:"Ngas"},{name:"Gas reserves",category:"Gas"},{name:"Thermal generation",category:"Thermal"},{name:"Geothermal",category:"Geothermal"},{name:"H2",category:"H2"},{name:"Hydro",category:"Hydro"},{name:"International shipping",category:"International"},{name:"Domestic aviation",category:"Domestic"},{name:"International aviation",category:"International"},{name:"National navigation",category:"National"},{name:"Marine algae",category:"Marine"},{name:"Nuclear",category:"Nuclear"},{name:"Oil imports",category:"Oil"},{name:"Oil",category:"Oil"},{name:"Oil reserves",category:"Oil"},{name:"Other waste",category:"Other"},{name:"Pumped heat",category:"Pumped"},{name:"Solar PV",category:"Solar"},{name:"Solar Thermal",category:"Solar"},{name:"Solar",category:"Solar"},{name:"Tidal",category:"Tidal"},{name:"UK land based bioenergy",category:"UK"},{name:"Wave",category:"Wave"},{name:"Wind",category:"Wind"}],links:[{source:"Agricultural 'waste'",target:"Bio-conversion",value:124.729},{source:"Bio-conversion",target:"Liquid",value:.597},{source:"Bio-conversion",target:"Losses",value:26.862},{source:"Bio-conversion",target:"Solid",value:280.322},{source:"Bio-conversion",target:"Gas",value:81.144},{source:"Biofuel imports",target:"Liquid",value:35},{source:"Biomass imports",target:"Solid",value:35},{source:"Coal imports",target:"Coal",value:11.606},{source:"Coal reserves",target:"Coal",value:63.965},{source:"Coal",target:"Solid",value:75.571},{source:"District heating",target:"Industry",value:10.639},{source:"District heating",target:"Heating and cooling - commercial",value:22.505},{source:"District heating",target:"Heating and cooling - homes",value:46.184},{source:"Electricity grid",target:"Over generation / exports",value:104.453},{source:"Electricity grid",target:"Heating and cooling - homes",value:113.726},{source:"Electricity grid",target:"H2 conversion",value:27.14},{source:"Electricity grid",target:"Industry",value:342.165},{source:"Electricity grid",target:"Road transport",value:37.797},{source:"Electricity grid",target:"Agriculture",value:4.412},{source:"Electricity grid",target:"Heating and cooling - commercial",value:40.858},{source:"Electricity grid",target:"Losses",value:56.691},{source:"Electricity grid",target:"Rail transport",value:7.863},{source:"Electricity grid",target:"Lighting & appliances - commercial",value:90.008},{source:"Electricity grid",target:"Lighting & appliances - homes",value:93.494},{source:"Gas imports",target:"Ngas",value:40.719},{source:"Gas reserves",target:"Ngas",value:82.233},{source:"Gas",target:"Heating and cooling - commercial",value:.129},{source:"Gas",target:"Losses",value:1.401},{source:"Gas",target:"Thermal generation",value:151.891},{source:"Gas",target:"Agriculture",value:2.096},{source:"Gas",target:"Industry",value:48.58},{source:"Geothermal",target:"Electricity grid",value:7.013},{source:"H2 conversion",target:"H2",value:20.897},{source:"H2 conversion",target:"Losses",value:6.242},{source:"H2",target:"Road transport",value:20.897},{source:"Hydro",target:"Electricity grid",value:6.995},{source:"Liquid",target:"Industry",value:121.066},{source:"Liquid",target:"International shipping",value:128.69},{source:"Liquid",target:"Road transport",value:135.835},{source:"Liquid",target:"Domestic aviation",value:14.458},{source:"Liquid",target:"International aviation",value:206.267},{source:"Liquid",target:"Agriculture",value:3.64},{source:"Liquid",target:"National navigation",value:33.218},{source:"Liquid",target:"Rail transport",value:4.413},{source:"Marine algae",target:"Bio-conversion",value:4.375},{source:"Ngas",target:"Gas",value:122.952},{source:"Nuclear",target:"Thermal generation",value:839.978},{source:"Oil imports",target:"Oil",value:504.287},{source:"Oil reserves",target:"Oil",value:107.703},{source:"Oil",target:"Liquid",value:611.99},{source:"Other waste",target:"Solid",value:56.587},{source:"Other waste",target:"Bio-conversion",value:77.81},{source:"Pumped heat",target:"Heating and cooling - homes",value:193.026},{source:"Pumped heat",target:"Heating and cooling - commercial",value:70.672},{source:"Solar PV",target:"Electricity grid",value:59.901},{source:"Solar Thermal",target:"Heating and cooling - homes",value:19.263},{source:"Solar",target:"Solar Thermal",value:19.263},{source:"Solar",target:"Solar PV",value:59.901},{source:"Solid",target:"Agriculture",value:.882},{source:"Solid",target:"Thermal generation",value:400.12},{source:"Solid",target:"Industry",value:46.477},{source:"Thermal generation",target:"Electricity grid",value:525.531},{source:"Thermal generation",target:"Losses",value:787.129},{source:"Thermal generation",target:"District heating",value:79.329},{source:"Tidal",target:"Electricity grid",value:9.452},{source:"UK land based bioenergy",target:"Bio-conversion",value:182.01},{source:"Wave",target:"Electricity grid",value:19.013},{source:"Wind",target:"Electricity grid",value:289.366}]};var Y=n(708);let J=["#e0ac2b","#e85252","#6689c6","#9a6fb0","#a53253"],Q=e=>{let{width:t,height:n,data:i}=e,o=[...new Set(i.nodes.map(e=>e.category))].sort(),a=(0,Y.PKp)().domain(o).range(J),s=A().nodeWidth(26).nodePadding(10).extent([[5,25],[t-5,n-25]]).nodeId(e=>e.name).nodeAlign(p),{nodes:l,links:c}=s(i),d=l.map(e=>(0,r.jsx)("g",{children:(0,r.jsx)("rect",{height:e.y1-e.y0,width:s.nodeWidth(),x:e.x0,y:e.y0,stroke:"black",fill:a(e.category),fillOpacity:1,rx:.9})},e.index)),h=c.map((e,t)=>{let n=F(),i=n(e);return(0,r.jsx)("path",{d:i,stroke:a(e.source.category),fill:"none",strokeOpacity:.3,strokeWidth:e.width},t)}),u=l.map((e,n)=>(0,r.jsx)("text",{x:e.x0<t/2?e.x1+6:e.x0-6,y:(e.y1+e.y0)/2,dy:"0.35rem",textAnchor:e.x0<t/2?"start":"end",fontSize:12,children:e.name},n));return(0,r.jsx)("div",{children:(0,r.jsxs)("svg",{width:t,height:n,children:[h,d,u]})})},ee=e=>{let{width:t=700,height:n=400}=e;return 0===t?null:(0,r.jsx)(Q,{data:$,width:t,height:n})},et=(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("p",{children:["A"," ",(0,r.jsx)("a",{href:"https://www.data-to-viz.com/graph/sankey.html",children:"Sankey Diagram"})," ","display ",(0,r.jsx)("b",{children:"flows"}),". Several entities (",(0,r.jsx)("b",{children:"nodes"}),") are represented by rectangles or text. Directed ",(0,r.jsx)("b",{children:"links"})," are represented with arrows or arcs that have a width proportional to the importance of the flow."]}),(0,r.jsxs)("p",{children:["This tutorial explains how to use ",(0,r.jsx)("code",{children:"React"}),", ",(0,r.jsx)("code",{children:"D3.js"})," ","and the ",(0,r.jsx)("code",{children:"d3-sankey"})," plugin to build a Sankey diagram. It comes with explanations and code sandboxes to play along with the suggested implementation."]})]});function en(){return(0,r.jsxs)(i.A,{title:"How to build a Sankey Diagram with React and D3.",seoDescription:"A step-by-step guide to build your very own Sankey Diagram from scratch. Comes with explanations, code sandboxes, and ready-to-use templates.",children:[(0,r.jsx)(o.Z,{title:"Sankey Diagram",description:et,chartType:"sankey"}),(0,r.jsx)("h2",{id:"data",children:"The Data"}),(0,r.jsxs)("p",{children:["Two layers of information are required to build a Sankey diagram: a list of ",(0,r.jsx)("b",{children:"nodes"})," to build the rectangles and a list of ",(0,r.jsx)("b",{children:"links"})," to build the paths between them."]}),(0,r.jsx)("p",{children:"Many different data structures can be used to store such information. In this tutorial I suggest to start with the following:"}),(0,r.jsx)(s.d,{code:er}),(0,r.jsxs)("p",{children:[(0,r.jsx)("code",{children:"data"})," is an object with 2 properties: ",(0,r.jsx)("code",{children:"nodes"})," and"," ",(0,r.jsx)("code",{children:"links"}),"."]}),(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"nodes"})," is an array where each node is an object defined by its index (",(0,r.jsx)("code",{children:"node"}),") and its ",(0,r.jsx)("code",{children:"name"}),". Note that any other feature can be added to nodes here."]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"links"})," is another array listing the connections. They are defined by a ",(0,r.jsx)("code",{children:"source"})," and a ",(0,r.jsx)("code",{children:"target"})," and optionnaly with a ",(0,r.jsx)("code",{children:"value"}),"."]})]}),(0,r.jsx)(h.H,{text:"Explain how to build this data structure from various initial formats"}),(0,r.jsx)("h2",{id:"skeleton",children:"Component skeleton"}),(0,r.jsxs)("p",{children:["The goal here is to create a ",(0,r.jsx)("code",{children:"Sankey"})," component that will be stored in a ",(0,r.jsx)("code",{children:"Sankey.tsx"})," file. This component requires 3 props to render: a ",(0,r.jsx)("code",{children:"width"}),", a ",(0,r.jsx)("code",{children:"height"}),", and some"," ",(0,r.jsx)("code",{children:"data"}),"."]}),(0,r.jsxs)("p",{children:["The shape of the ",(0,r.jsx)("code",{children:"data"})," is described above. The"," ",(0,r.jsx)("code",{children:"width"})," and ",(0,r.jsx)("code",{children:"height"})," will be used to render an"," ",(0,r.jsx)("code",{children:"svg"})," element in the DOM, in which we will insert the Sankey."]}),(0,r.jsxs)("p",{children:["To put it in a nutshell, that's the skeleton of our ",(0,r.jsx)("code",{children:"Sankey"})," ","component:"]}),(0,r.jsx)(s.d,{code:ei}),(0,r.jsxs)("p",{children:["It's fundamental to understand that with this code organization, d3.js will be used to layout (",(0,r.jsx)("code",{children:"rect"})," and ",(0,r.jsx)("code",{children:"path"})," ","positions), but it's React that will render them in the"," ",(0,r.jsx)("code",{children:"return()"})," statement. We won't use d3 methods like"," ",(0,r.jsx)("code",{children:"append"})," that you can find in usual"," ",(0,r.jsx)("a",{href:"https://www.d3-graph-gallery.com",children:"d3.js examples"}),"."]}),(0,r.jsx)("h2",{id:"Nodes",children:"Draw the nodes"}),(0,r.jsxs)("p",{children:["To draw the nodes we first need to compute their positions on the SVG area. This is where the"," ",(0,r.jsx)("a",{href:"https://github.com/d3/d3-sankey",children:"d3-sankey plugin"})," gets helpful with its ",(0,r.jsx)("code",{children:"sankey()"}),"function."]}),(0,r.jsxs)("p",{children:["The ",(0,r.jsx)("code",{children:"sankey()"})," function must be called with a set of options described below as inline comments:"]}),(0,r.jsx)(s.d,{code:eo}),(0,r.jsxs)("p",{children:["We now have a function called ",(0,r.jsx)("code",{children:"sankeyGenerator"})," that computes the sankey layout from our dataset. We can use it as follow:"]}),(0,r.jsx)(s.d,{code:ea}),(0,r.jsxs)("p",{children:["And that's it. We now have 2 objects called ",(0,r.jsx)("code",{children:"nodes"})," and"," ",(0,r.jsx)("code",{children:"links"})," that provide all the necessary information about nodes and links. ",(0,r.jsx)("code",{children:"nodes"})," is an array. For each item we have",(0,r.jsx)("code",{children:"x0"}),", ",(0,r.jsx)("code",{children:"y0"}),", ",(0,r.jsx)("code",{children:"x1"})," and ",(0,r.jsx)("code",{children:"y1"})," ","that are the coordinates of the top-left and bottom right corners of the rectangle. We are ready for the drawing! ✏️"]}),(0,r.jsx)(l.$,{VizComponent:X,vizName:"SankeyDiagramNodeOnly",maxWidth:500,height:300,caption:"First step of our ongoing sankey diagram: the nodes are displayed using rectangles."}),(0,r.jsx)("h2",{id:"connections",children:"Draw the connections"}),(0,r.jsxs)("p",{children:["The other object we got from the ",(0,r.jsx)("code",{children:"sankey()"})," function is"," ",(0,r.jsx)("code",{children:"links"}),". It is an array where each item provides detail about a link."]}),(0,r.jsx)("p",{children:"Each item is an object with several properties. Among them:"}),(0,r.jsxs)("ul",{children:[(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"width"})," → provides the width of the arc we will build. We will pass it to the ",(0,r.jsx)("code",{children:"strokeWidth"})," property of the SVG"," ",(0,r.jsx)("code",{children:"path"}),"."]}),(0,r.jsxs)("li",{children:[(0,r.jsx)("code",{children:"source"})," and ",(0,r.jsx)("code",{children:"target"})," → provide a lot of details about the source and target nodes, including their positions. It makes it possible to pass a link to the"," ",(0,r.jsx)("code",{children:"sankeyLinkHorizontal()"})," function to get the SVG path we will give as the ",(0,r.jsx)("code",{children:"d"})," argument."]})]}),(0,r.jsxs)("p",{children:["To put it in a nutshell, we can loop through the ",(0,r.jsx)("code",{children:"links"})," ","array and draw a",(0,r.jsx)("code",{children:"path"})," as follow:"]}),(0,r.jsx)(s.d,{code:es}),(0,r.jsx)("p",{children:"Resulting in a first Sankey diagram \uD83C\uDF89"}),(0,r.jsx)(l.$,{VizComponent:Z,vizName:"SankeyDiagramBasic",maxWidth:500,height:300,caption:"First step of our ongoing arc diagram: the nodes are displayed at the bottom of the figure."}),(0,r.jsx)(d.r,{chartId:"sankey"}),(0,r.jsx)(c.Z,{chartId:"sankey"}),(0,r.jsx)("h2",{id:"application",children:"Application to a real dataset"}),(0,r.jsxs)("p",{children:["This Sankey diagram visualizes the flow of energy: supplies are on the left, and demands are on the right. It is a reproduction of this famous observable"," ",(0,r.jsx)("a",{href:"https://observablehq.com/@d3/sankey/2?intent=fork",children:"example"}),". Links show how varying amounts of energy are converted or transmitted before being consumed or lost."]}),(0,r.jsxs)("p",{children:["The code is very similar to the example above. On top of it, a"," ",(0,r.jsx)("b",{children:"color scale"})," is used for the node and connection colors, and some text ",(0,r.jsx)("b",{children:"labels"})," have been added."]}),(0,r.jsx)(l.$,{VizComponent:ee,vizName:"SankeyDiagramEnergyFlow",maxWidth:1e3,height:800,caption:"A Sankey diagram showing the flow of energy. Supplies on the left, demands on the right."}),(0,r.jsx)(h.H,{text:"Add hover effect to highlight links"}),(0,r.jsx)(h.H,{text:"Add gradient along links"}),(0,r.jsx)(h.H,{text:"Fix types"}),(0,r.jsx)("div",{className:"full-bleed border-t h-0 bg-gray-100 mb-3 mt-24"}),(0,r.jsx)(a.Z,{chartFamily:"flow"}),(0,r.jsx)("div",{className:"mt-20"})]})}let er='\nconst data = {\n  nodes: [\n      { node: 0, name: "node0" },\n      { node: 1, name: "node1" },\n      { node: 2, name: "node2" },\n      { node: 3, name: "node3" },\n  ],\n  links: [\n      { source: 0, target: 2, value: 2 },\n      { source: 1, target: 2, value: 2 },\n      { source: 1, target: 3, value: 2 },\n  ]\n}\n\n'.trim(),ei='\nimport * as d3 from "d3"; // we will need d3.js\n\ntype SankeyProps = {\n  width: number;\n  height: number;\n  data: number[];\n};\n\nexport const Sankey = ({ width, height, data }: SankeyProps) => {\n\n  // read the data\n  // create a color scale for the nodes\n  // compute node position thanks to the d3.sankey() function\n  // build the rectangles and arcs\n\n  return (\n    <div>\n      <svg width={width} height={height}>\n        // render all the <rect> and <path>\n      </svg>\n    </div>\n  );\n};\n'.trim(),eo="\nconst sankeyGenerator = sankey()  // Main function of the d3-sankey plugin that computes the layout\n    .nodeWidth(26)                  // width of the node in pixels\n    .nodePadding(29)                // space between nodes\n    .extent([                       // chart area:\n      [MARGIN_X, MARGIN_Y],                   // top-left coordinates\n      [width - MARGIN_X, height - MARGIN_Y],  // botton-right coordinates\n    ])\n    .nodeId((node) => node.id)      // Accessor function: how to retrieve the id that defines each node. This id is then used for the source and target props of links\n    .nodeAlign(sankeyCenter);       // Algorithm used to decide node position\n".trim(),ea="\nconst { nodes, links } = sankeyGenerator(data);\n".trim(),es='\nconst allLinks = links.map((link, i) => {\n  const linkGenerator = sankeyLinkHorizontal();\n  const path = linkGenerator(link);\n\n  return (\n    <path\n      key={i}\n      d={path}\n      stroke="#a53253"\n      fill="none"\n      strokeOpacity={0.1}\n      strokeWidth={link.width}\n    />\n  );\n});\n'.trim()}},function(e){e.O(0,[3996,708,5660,645,1188,9774,2888,179],function(){return e(e.s=1248)}),_N_E=e.O()}]);